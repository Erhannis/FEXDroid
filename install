#!/bin/sh
echo""
echo "installing ..."
echo ""
termux-setup-storage & sleep 3 &>/dev/null
pkg update -y

clear
echo ""
echo " Installing x11 repo"
echo ""
pkg install x11-repo -y &>/dev/null

echo "installed"
echo ""
echo "installing pulseaudio and proot-distro package"

pkg install pulseaudio wget xkeyboard-config proot-distro -y &>/dev/null

echo ""
echo "Done"
echo ""
echo " Installing Termux-x11...."
echo ""
pkg install termux-x11-nightly -y &>/dev/null

echo " Termux-x11 installed"

red='\033[0;31m'
clear='\033[0m'
echo "${red}WARNING${clear}!!!"

sleep 2

echo "By Installing This Setup Your old Distro is Removed"

echo "If you Have 'Box64droid' or Any Ubuntu Installed Don't Install it!"
while true; do

read -p "Do you want to proceed? (y/n) " yn

case $yn in 
	[yY] ) echo Removing old Distro...;
		break;;
	[nN] ) echo exiting...;
		exit;;
	* ) echo invalid response;;
esac

done

proot-distro remove ubuntu &>dev/null

echo ""

echo "Downloading preconfigured ubuntu..."

wget -q --show-progress https://github.com/gamextra4u/FEXDroid/releases/download/v0.1/ubuntu.tar.xz
echo""
echo " Installing the rootfs, please wait..."
  proot-distro restore ubuntu.tar.xz &>/dev/null
  
  echo ""
echo " RootFS installed"
  
  echo ""
  
  echo " Downloading FEXDroid starting scripts..."
  
  wget https://raw.githubusercontent.com/gamextra4u/FEXDroid/v0.1/fexdroid &>/dev/null
  chmod +x fexdroid
  mv fexdroid $PREFIX/bin/fexdroid
  
  cd /data/data/com.termux/files/usr/var/lib/proot-distro/installed-rootfs/ubuntu/root/
  
  wget https://raw.githubusercontent.com/gamextra4u/FEXDroid/main/rootfs
chmod +x rootfs
  
  
  echo ""
echo " Scripts installed"
echo ""
  clear
echo ""
echo " Install finished. To start FEXDroid run 'fexdroid' and type './rootfs' 
sleep 3
echo ""
